Initializing...
Parameters:
   predicting at size [288*384]
   using ResNet34, optimizer: Adam (lr=0.0001, beta=(0.9, 0.99)), scheduler: StepLR(60, 0.5)
   loss function --- Lp_depth: L1, tsegmt: cross, alpha: 0.0001, gamma: 0.0001, smoothing: 0.1
   batch size: 6, train for 90 epochs
   device: cuda
TransferNet type:
   Base Task TransferNet with skip-connection
Options:
   use uncertainty weights
Loading dataset...
=======================================
Start training...
Epoch 1/90 [1.7min] --- train loss: 0.29949 --- valid loss: 0.24806
Uncertainty weights: segmt=1.00306, depth=0.99395
Saving weights...
Epoch 2/90 [1.7min] --- train loss: 0.23824 --- valid loss: 0.23254
Uncertainty weights: segmt=0.99969, depth=0.98691
Saving weights...
Epoch 3/90 [1.7min] --- train loss: 0.22678 --- valid loss: 0.22178
Uncertainty weights: segmt=0.99383, depth=0.98039
Saving weights...
Epoch 4/90 [1.7min] --- train loss: 0.21887 --- valid loss: 0.22711
Uncertainty weights: segmt=0.98796, depth=0.97394
Epoch 5/90 [1.7min] --- train loss: 0.21221 --- valid loss: 0.22466
Uncertainty weights: segmt=0.98209, depth=0.96759
Epoch 6/90 [1.7min] --- train loss: 0.20721 --- valid loss: 0.20895
Uncertainty weights: segmt=0.97633, depth=0.96129
Saving weights...
Epoch 7/90 [1.7min] --- train loss: 0.20335 --- valid loss: 0.20290
Uncertainty weights: segmt=0.97059, depth=0.95508
Saving weights...
Epoch 8/90 [1.7min] --- train loss: 0.19708 --- valid loss: 0.19516
Uncertainty weights: segmt=0.96489, depth=0.94887
Saving weights...
Epoch 9/90 [1.7min] --- train loss: 0.19535 --- valid loss: 0.19432
Uncertainty weights: segmt=0.95933, depth=0.94273
Saving weights...
Epoch 10/90 [1.7min] --- train loss: 0.19066 --- valid loss: 0.19403
Uncertainty weights: segmt=0.95373, depth=0.93667
Saving weights...
Epoch 11/90 [1.7min] --- train loss: 0.18772 --- valid loss: 0.18578
Uncertainty weights: segmt=0.94854, depth=0.93060
Saving weights...
Epoch 12/90 [1.7min] --- train loss: 0.18427 --- valid loss: 0.18706
Uncertainty weights: segmt=0.94327, depth=0.92461
Epoch 13/90 [1.7min] --- train loss: 0.18024 --- valid loss: 0.18727
Uncertainty weights: segmt=0.93795, depth=0.91860
Epoch 14/90 [1.7min] --- train loss: 0.17745 --- valid loss: 0.17842
Uncertainty weights: segmt=0.93285, depth=0.91270
Saving weights...
Epoch 15/90 [1.7min] --- train loss: 0.17497 --- valid loss: 0.17210
Uncertainty weights: segmt=0.92786, depth=0.90686
Saving weights...
Epoch 16/90 [1.7min] --- train loss: 0.17068 --- valid loss: 0.16903
Uncertainty weights: segmt=0.92284, depth=0.90105
Saving weights...
Epoch 17/90 [1.7min] --- train loss: 0.16567 --- valid loss: 0.17794
Uncertainty weights: segmt=0.91753, depth=0.89525
Epoch 18/90 [1.7min] --- train loss: 0.16304 --- valid loss: 0.16634
Uncertainty weights: segmt=0.91264, depth=0.88948
Saving weights...
Epoch 19/90 [1.7min] --- train loss: 0.16251 --- valid loss: 0.16810
Uncertainty weights: segmt=0.90768, depth=0.88386
Epoch 20/90 [1.7min] --- train loss: 0.15913 --- valid loss: 0.16541
Uncertainty weights: segmt=0.90285, depth=0.87827
Saving weights...
Epoch 21/90 [1.7min] --- train loss: 0.15493 --- valid loss: 0.15989
Uncertainty weights: segmt=0.89822, depth=0.87260
Saving weights...
Epoch 22/90 [1.7min] --- train loss: 0.15180 --- valid loss: 0.16363
Uncertainty weights: segmt=0.89372, depth=0.86710
Epoch 23/90 [1.7min] --- train loss: 0.14614 --- valid loss: 0.15503
Uncertainty weights: segmt=0.88887, depth=0.86150
Saving weights...
Epoch 24/90 [1.7min] --- train loss: 0.14374 --- valid loss: 0.14762
Uncertainty weights: segmt=0.88399, depth=0.85605
Saving weights...
Epoch 25/90 [1.7min] --- train loss: 0.14131 --- valid loss: 0.14496
Uncertainty weights: segmt=0.87943, depth=0.85069
Saving weights...
Epoch 26/90 [1.7min] --- train loss: 0.13864 --- valid loss: 0.14709
Uncertainty weights: segmt=0.87489, depth=0.84520
Epoch 27/90 [1.7min] --- train loss: 0.13154 --- valid loss: 0.14459
Uncertainty weights: segmt=0.87017, depth=0.83982
Saving weights...
Epoch 28/90 [1.7min] --- train loss: 0.12939 --- valid loss: 0.14389
Uncertainty weights: segmt=0.86550, depth=0.83456
Saving weights...
Epoch 29/90 [1.7min] --- train loss: 0.12496 --- valid loss: 0.13607
Uncertainty weights: segmt=0.86073, depth=0.82935
Saving weights...
Epoch 30/90 [1.7min] --- train loss: 0.12519 --- valid loss: 0.13460
Uncertainty weights: segmt=0.85659, depth=0.82403
Saving weights...
Epoch 31/90 [1.7min] --- train loss: 0.12110 --- valid loss: 0.13254
Uncertainty weights: segmt=0.85221, depth=0.81886
Saving weights...
Epoch 32/90 [1.7min] --- train loss: 0.11761 --- valid loss: 0.14144
Uncertainty weights: segmt=0.84761, depth=0.81368
Epoch 33/90 [1.7min] --- train loss: 0.11625 --- valid loss: 0.13598
Uncertainty weights: segmt=0.84346, depth=0.80859
Epoch 34/90 [1.7min] --- train loss: 0.11038 --- valid loss: 0.13566
Uncertainty weights: segmt=0.83880, depth=0.80346
Epoch 35/90 [1.7min] --- train loss: 0.10925 --- valid loss: 0.12226
Uncertainty weights: segmt=0.83451, depth=0.79847
Saving weights...
Epoch 36/90 [1.7min] --- train loss: 0.10625 --- valid loss: 0.12413
Uncertainty weights: segmt=0.83010, depth=0.79355
Epoch 37/90 [1.7min] --- train loss: 0.10572 --- valid loss: 0.11465
Uncertainty weights: segmt=0.82612, depth=0.78859
Saving weights...
Epoch 38/90 [1.7min] --- train loss: 0.10059 --- valid loss: 0.12457
Uncertainty weights: segmt=0.82214, depth=0.78382
Epoch 39/90 [1.7min] --- train loss: 0.09542 --- valid loss: 0.12347
Uncertainty weights: segmt=0.81772, depth=0.77901
Epoch 40/90 [1.7min] --- train loss: 0.09522 --- valid loss: 0.11762
Uncertainty weights: segmt=0.81394, depth=0.77418
Epoch 41/90 [1.7min] --- train loss: 0.09708 --- valid loss: 0.11724
Uncertainty weights: segmt=0.81017, depth=0.76951
Epoch 42/90 [1.7min] --- train loss: 0.08819 --- valid loss: 0.11920
Uncertainty weights: segmt=0.80594, depth=0.76480
Epoch 43/90 [1.7min] --- train loss: 0.08884 --- valid loss: 0.11834
Uncertainty weights: segmt=0.80232, depth=0.76013
Epoch 44/90 [1.7min] --- train loss: 0.08423 --- valid loss: 0.13142
Uncertainty weights: segmt=0.79827, depth=0.75552
Epoch 45/90 [1.7min] --- train loss: 0.07919 --- valid loss: 0.11174
Uncertainty weights: segmt=0.79425, depth=0.75092
Saving weights...
Epoch 46/90 [1.7min] --- train loss: 0.07930 --- valid loss: 0.11963
Uncertainty weights: segmt=0.79063, depth=0.74629
Epoch 47/90 [1.7min] --- train loss: 0.07504 --- valid loss: 0.10432
Uncertainty weights: segmt=0.78696, depth=0.74183
Saving weights...
Epoch 48/90 [1.7min] --- train loss: 0.07305 --- valid loss: 0.10777
Uncertainty weights: segmt=0.78296, depth=0.73747
Epoch 49/90 [1.7min] --- train loss: 0.07086 --- valid loss: 0.10151
Uncertainty weights: segmt=0.77914, depth=0.73314
Saving weights...
Epoch 50/90 [1.7min] --- train loss: 0.06926 --- valid loss: 0.10101
Uncertainty weights: segmt=0.77565, depth=0.72882
Saving weights...
Epoch 51/90 [1.7min] --- train loss: 0.06414 --- valid loss: 0.10890
Uncertainty weights: segmt=0.77182, depth=0.72445
Epoch 52/90 [1.7min] --- train loss: 0.06056 --- valid loss: 0.09635
Uncertainty weights: segmt=0.76832, depth=0.72014
Saving weights...
Epoch 53/90 [1.7min] --- train loss: 0.05725 --- valid loss: 0.09944
Uncertainty weights: segmt=0.76463, depth=0.71597
Epoch 54/90 [1.7min] --- train loss: 0.05471 --- valid loss: 0.10799
Uncertainty weights: segmt=0.76090, depth=0.71180
Epoch 55/90 [1.7min] --- train loss: 0.04981 --- valid loss: 0.11439
Uncertainty weights: segmt=0.75708, depth=0.70763
Epoch 56/90 [1.7min] --- train loss: 0.04715 --- valid loss: 0.08925
Uncertainty weights: segmt=0.75330, depth=0.70364
Saving weights...
Epoch 57/90 [1.7min] --- train loss: 0.04730 --- valid loss: 0.09938
Uncertainty weights: segmt=0.74981, depth=0.69964
Epoch 58/90 [1.7min] --- train loss: 0.04511 --- valid loss: 0.10455
Uncertainty weights: segmt=0.74659, depth=0.69550
Epoch 59/90 [1.7min] --- train loss: 0.04124 --- valid loss: 0.09904
Uncertainty weights: segmt=0.74304, depth=0.69163
Epoch 60/90 [1.7min] --- train loss: 0.03674 --- valid loss: 0.10318
Uncertainty weights: segmt=0.73923, depth=0.68771
Epoch 61/90 [1.7min] --- train loss: 0.02358 --- valid loss: 0.08677
Uncertainty weights: segmt=0.73708, depth=0.68563
Saving weights...
Epoch 62/90 [1.7min] --- train loss: 0.01609 --- valid loss: 0.08629
Uncertainty weights: segmt=0.73486, depth=0.68360
Saving weights...
Epoch 63/90 [1.7min] --- train loss: 0.01523 --- valid loss: 0.10072
Uncertainty weights: segmt=0.73274, depth=0.68165
Epoch 64/90 [1.7min] --- train loss: 0.01370 --- valid loss: 0.08745
Uncertainty weights: segmt=0.73077, depth=0.67963
Epoch 65/90 [1.7min] --- train loss: 0.00963 --- valid loss: 0.08248
Uncertainty weights: segmt=0.72863, depth=0.67762
Saving weights...
Epoch 66/90 [1.7min] --- train loss: 0.00176 --- valid loss: 0.08493
Uncertainty weights: segmt=0.72649, depth=0.67554
Epoch 67/90 [1.7min] --- train loss: 0.00292 --- valid loss: 0.08060
Uncertainty weights: segmt=0.72440, depth=0.67357
Saving weights...
Epoch 68/90 [1.7min] --- train loss: 0.00237 --- valid loss: 0.09005
Uncertainty weights: segmt=0.72239, depth=0.67162
Epoch 69/90 [1.7min] --- train loss: -0.00005 --- valid loss: 0.09037
Uncertainty weights: segmt=0.72029, depth=0.66965
Epoch 70/90 [1.7min] --- train loss: -0.00156 --- valid loss: 0.08394
Uncertainty weights: segmt=0.71813, depth=0.66771
Epoch 71/90 [1.7min] --- train loss: -0.00236 --- valid loss: 0.08374
Uncertainty weights: segmt=0.71608, depth=0.66577
Epoch 72/90 [1.7min] --- train loss: -0.00971 --- valid loss: 0.08425
Uncertainty weights: segmt=0.71395, depth=0.66376
Epoch 73/90 [1.7min] --- train loss: -0.01092 --- valid loss: 0.08878
Uncertainty weights: segmt=0.71180, depth=0.66185
Epoch 74/90 [1.7min] --- train loss: -0.01402 --- valid loss: 0.09128
Uncertainty weights: segmt=0.70967, depth=0.65997
Epoch 75/90 [1.7min] --- train loss: -0.01180 --- valid loss: 0.09203
Uncertainty weights: segmt=0.70761, depth=0.65806
Epoch 76/90 [1.7min] --- train loss: -0.01505 --- valid loss: 0.08271
Uncertainty weights: segmt=0.70553, depth=0.65617
Epoch 77/90 [1.7min] --- train loss: -0.01694 --- valid loss: 0.08980
Uncertainty weights: segmt=0.70348, depth=0.65426
Epoch 78/90 [1.7min] --- train loss: -0.01916 --- valid loss: 0.09756
Uncertainty weights: segmt=0.70140, depth=0.65234
Epoch 79/90 [1.7min] --- train loss: -0.02481 --- valid loss: 0.09911
Uncertainty weights: segmt=0.69920, depth=0.65045
Epoch 80/90 [1.7min] --- train loss: -0.02588 --- valid loss: 0.09346
Uncertainty weights: segmt=0.69713, depth=0.64855
Epoch 81/90 [1.7min] --- train loss: -0.02454 --- valid loss: 0.09655
Uncertainty weights: segmt=0.69518, depth=0.64663
Epoch 82/90 [1.7min] --- train loss: -0.02514 --- valid loss: 0.09589
Uncertainty weights: segmt=0.69321, depth=0.64482
Epoch 83/90 [1.7min] --- train loss: -0.02780 --- valid loss: 0.09422
Uncertainty weights: segmt=0.69112, depth=0.64301
Epoch 84/90 [1.7min] --- train loss: -0.02923 --- valid loss: 0.10385
Uncertainty weights: segmt=0.68909, depth=0.64124
Epoch 85/90 [1.7min] --- train loss: -0.03471 --- valid loss: 0.09349
Uncertainty weights: segmt=0.68707, depth=0.63940
Epoch 86/90 [1.7min] --- train loss: -0.03344 --- valid loss: 0.08452
Uncertainty weights: segmt=0.68504, depth=0.63760
Epoch 87/90 [1.7min] --- train loss: -0.03434 --- valid loss: 0.10977
Uncertainty weights: segmt=0.68304, depth=0.63590
Epoch 88/90 [1.7min] --- train loss: -0.03867 --- valid loss: 0.10694
Uncertainty weights: segmt=0.68097, depth=0.63412
Epoch 89/90 [1.7min] --- train loss: -0.04055 --- valid loss: 0.09962
Uncertainty weights: segmt=0.67902, depth=0.63228
Epoch 90/90 [1.7min] --- train loss: -0.04226 --- valid loss: 0.09355
Uncertainty weights: segmt=0.67702, depth=0.63052
Training done
=======================================
Clipping input data to the valid range for imshow with RGB data ([0..1] for floats or [0..255] for integers).
Pix Acc: 0.6030, mIoU: 0.2600
Scores - RMSE: 3.0776, iRMSE: 0.6914, iRMSE log: 2.9092, Abs: 0.5110, Abs Rel: 0.2305, Sqrt Rel: 0.1993, delta1: 0.5142, delta2: 0.7500, delta3: 0.8319
